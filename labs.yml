---
name: remorph
description: Code Transpiler and Data Reconciliation tool for Accelerating Data onboarding to Databricks from EDW, CDW and other ETL sources.
install:
  min_runtime_version: 13.3
  require_running_cluster: false
  require_databricks_connect: true
  script: src/databricks/labs/remorph/install.py
uninstall:
  script: src/databricks/labs/remorph/uninstall.py
entrypoint: src/databricks/labs/remorph/cli.py
min_python: 3.10
commands:
  - name: transpile
    description: Transpile SQL script to Databricks SQL
    flags:
      - name: source
        description: Input SQL Dialect Type Accepted Values [snowflake, tsql]
      - name: input-sql
        description: Input SQL Folder or File
      - name: output-folder
        default: None
        description: Output Location For Storing Transpiled Cod
      - name: skip-validation
        default: true
        description: Validate Transpiled Code, default True validation skipped, False validate
      - name: catalog-name
        description: Catalog Name Applicable only when Validation Mode is DATABRICKS
      - name: schema-name
        description: Schema Name Applicable only when Validation Mode is DATABRICKS
      - name: mode
        default: current
        description: Run in Current or Experimental Mode, Accepted Values [experimental, current], Default current, experimental mode will execute including any Private Preview features

    table_template: |-
      total_files_processed\ttotal_queries_processed\tno_of_sql_failed_while_parsing\tno_of_sql_failed_while_validating\terror_log_file
      {{range .}}{{.total_files_processed}}\t{{.total_queries_processed}}\t{{.no_of_sql_failed_while_parsing}}\t{{.no_of_sql_failed_while_validating}}\t{{.error_log_file}}
      {{end}}
  - name: reconcile
    description: Reconcile is an utility to streamline the reconciliation process between source data and target data residing on Databricks.
    flags:
      - name: recon_conf
        description: Path of the data-recon config
      - name: conn_profile
        description: Path of the source connection config
      - name: source
        description: Source Type, Accepted Values [snowflake]
      - name: report
        default: all
        description: Report type
  - name: generate-lineage
    description: Utility to generate a lineage of the SQL files
    flags:
      - name: source
        description: Input SQL Dialect Type Accepted Values [snowflake, tsql]
      - name: input-sql
        description: Input SQL Folder or File
      - name: output-folder
        description: Directory to store the generated lineage file
  - name: configure-secrets
    description: Utility to setup Scope and Secrets on Databricks Workspace
